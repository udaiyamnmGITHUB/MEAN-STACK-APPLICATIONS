"use strict"

var fs = require('fs')
var crypto = require('crypto')

var VALID_ALGORITHMS = [
  'md4',
  'md5',
  'sha1',
  'sha256'
]

module.exports = function hashFile(fileName, algorithm, fn) {
  // algorithm is optional
  if (arguments.length === 2 && typeof algorithm === 'function') {
    fn = algorithm
    algorithm = 'md5'
  }
  

  if (VALID_ALGORITHMS.indexOf(algorithm) === -1) {
    var err = new Error('unsupported algorithm:' + algorithm)
    if (fn) return fn(err)
    throw err
  }

  var shasu